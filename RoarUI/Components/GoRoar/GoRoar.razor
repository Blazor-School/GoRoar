@namespace RoarUI
@using RoarUI.Services
@inject RoarDependencyService RoarDependencyService
@implements IDisposable

@ChildContent
<script type="module">
    import { setBasePath } from '@Assets[$"{InternalPaths.BaseWebAwesomePath}/webawesome.js"]';
    setBasePath('@InternalPaths.BaseWebAwesomePath');
</script>
<script>
    window.executeMethodFromInstance = function (instance, methodName, ...params)
    {
        instance[methodName](...params);
    }
</script>

@foreach (var component in RoarDependencyService.Components)
{
    <script type="module" src="@Assets[InternalPaths.ComposeWebAwesomeComponentJsPath(component)]"></script>
}

@* <style>
    :root {
        --wa-color-neutral-fill-quiet: red;
        --wa-color-neutral-fill-normal: red;
        --wa-color-neutral-fill-loud: red;
        --wa-color-neutral-border-quiet: red;
        --wa-color-neutral-border-normal: red;
        --wa-color-neutral-border-loud: red;
        --wa-color-neutral-on-quiet: red;
        --wa-color-neutral-on-normal: #ffffff;
        --wa-color-neutral-on-loud: #ffffff;
    }
</style> *@

@code {
    [Parameter]
    public RenderFragment? ChildContent { get; set; }

    protected override void OnInitialized()
    {
        RoarDependencyService.OnComponentsChanged += OnComponentsChangedHandler;
    }

    public void OnComponentsChangedHandler(object? sender, EventArgs args)
    {
        StateHasChanged();
    }

    public void Dispose()
    {
        RoarDependencyService.OnComponentsChanged -= OnComponentsChangedHandler;
    }
}